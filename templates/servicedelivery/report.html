{% extends 'home.html' %}
{% block page-title-var %}Report Service Delivery{% endblock page-title-var %}

{% block application-active %}
    <div class="container" style="text-align: center; margin-bottom: 1%;">
     <button class="btn btn-outline-info btn-block" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
            Filter using a Date Range
     </button>
    <div class="collapse" id="collapseExample">
        <div class="container" style="margin-top: 3%;margin-bottom: 3%;  ">
      <div class="form-group pmd-textfield pmd-textfield-floating-label">
          <form action="{% url 'report_servicedelivery' %}" method="post" id="myform">
              {% csrf_token %}
            <h3>Select Date Range</h3>
                <input type="text" class="form-control" style="display: inline-block; width: auto;" name="daterange" id="demo" />
              <button type="submit" id="filter" class=" btn btn-outline-primary">Filter</button>
          </form>
      </div>
<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>

        <script>
            $('#demo').daterangepicker({
                ranges: {
                    'Today': [moment(), moment()],
                    'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                    'Last 7 Days': [moment().subtract(6, 'days'), moment()],
                    'Last 30 Days': [moment().subtract(29, 'days'), moment()],
                    'This Month': [moment().startOf('month'), moment().endOf('month')],
                    'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                },
                "linkedCalendars": false,
                "autoUpdateInput": false,
                "alwaysShowCalendars": true,
                "startDate": "06/15/2019",
                "endDate": "06/21/2019"
            }, function(start, end, label) {
              console.log('New date range selected: ' + start.format('YYYY-MM-DD') + ' to ' + end.format('YYYY-MM-DD') + ' (predefined range: ' + label + ')');
              $('#demo').val(start.format('YYYY-MM-DD')+'/'+end.format('YYYY-MM-DD'));
            });
        </script>
        </div>
    </div>
    </div>
 <nav class="nav nav-tabs nav-justified">
                    <a class="nav-item nav-link" id="hag" data-toggle="tab" href="#home">Inward</a>
                    <a class="nav-item nav-link" data-toggle="tab" href="#menu1">Outward</a>
 </nav>
     <div class="tab-content">
                    <div id="home" class="tab-pane fade in">
                        <table  class="table table-striped table-bordered" style="width:100%">
                            <thead>
                                <tr>
                                    <th>Purchase Order Number</th>
                                    <th>Vendor</th>
                                    <th>Quantity</th>
                                    <th>Price</th>
                                    <th>Transporter Detail</th>
                                    <th>Final Freight</th>
                                    <th>Pick up date/time</th>
                                    <th>Dispatch Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for purchaseorderproduct in purchaseorderproducts %}
                                    <tr class="{% if purchaseorderproduct.received_status != True %} table-danger{% else %} table-success{% endif %} ">
                                    <td>{{ purchaseorderproduct.purchaseorder.purchaseorder_number }}</td>
                                    <td>{{ purchaseorderproduct.purchaseorder.vendor }}</td>
                                    <td>{{ purchaseorderproduct.quantity }}</td>
                                    <td>{{ purchaseorderproduct.purchase_price }}</td>
                                    <td>{{ purchaseorderproduct.transporter_detail }}</td>
                                    <td>{{ purchaseorderproduct.freight }}</td>
                                    <td>{{ purchaseorderproduct.pickup_date_time }}</td>
                                    <td>
                                        {% if purchaseorderproduct.received_status == True %}
                                            Received
                                        {% else  %}
                                            Not yet Received
                                        {% endif %}
                                    </td>

                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                        <div class="container" style="text-align: center">

                            <h3>Receiving Total Quantity = {{ total_receiving_quantity }}</h3>
                            <h3>Receiving Total Amount = {{ total_receiving_amount }} </h3>
                            <h3>Receiving Total Freight ={{ total_receiving_freight }}</h3>

                        </div>
                    </div>
                    <div id="menu1" class="tab-pane fade in">
                        <table  class="table table-striped table-bordered" style="width:100%">
                            <thead>
                                <tr>
                                    <th>Sales order Number</th>
                                    <th>Buyer</th>
                                    <th>Quantity</th>
                                    <th>Price</th>
                                    <th>Transporter Detail</th>
                                    <th>Final Freight</th>
                                    <th>Pick up date/time</th>
                                    <th>Dispatch Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for salesorderproduct in salesorderproducts %}
                                    <tr class="{% if salesorderproduct.dispatched_status != True %} table-danger{% else %} table-success{% endif %} ">
                                    <td>{{ salesorderproduct.salesorder.salesorder_number }}</td>
                                    <td>{{ salesorderproduct.salesorder.buyer }}</td>
                                    <td>{{ salesorderproduct.quantity }}</td>
                                    <td>{{ salesorderproduct.so_selling_price }}</td>
                                    <td>{{ salesorderproduct.transporter_detail }}</td>
                                    <td>{{ salesorderproduct.freight }}</td>
                                    <td>{{ salesorderproduct.outward_date_time }}</td>
                                    <td>
                                        {% if salesorderproduct.dispatched_status == True %}
                                            Dispatched
                                        {% else  %}
                                            Not yet Dispatched
                                        {% endif %}
                                    </td>

                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                        <div class="container" style="text-align: center">

                            <h3> Total Dispatching Quantity = {{ total_dispatching_quantity }}</h3>
                            <h3> Total Dispatching Amount = {{ total_dispatching_amount }} </h3>
                            <h3> Total Dispatching Freight = {{ total_dispatching_freight }}</h3>

                        </div>
                    </div>
     </div>
    <script>
    $('#hag').click();
    </script>


{% endblock application-active %}